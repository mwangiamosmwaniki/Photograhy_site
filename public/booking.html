<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- SEO Meta Tags -->
    <title>
      Jr Photography | Professional Wedding, Portrait & Event Photography
    </title>
    <meta
      name="description"
      content="Lens & Light offers award-winning wedding, portrait, and event photography. Explore featured work, custom packages, and book a session today."
    />
    <meta
      name="keywords"
      content="photography, wedding photography, portrait photography, event photography, professional photographer, photo sessions"
    />
    <meta name="author" content="Jr Photography" />

    <!-- Open Graph / Social Sharing -->
    <meta property="og:title" content="Jr Photography" />
    <meta
      property="og:description"
      content="Capturing life's most precious moments with professional photography services."
    />
    <meta property="og:image" content="images/hero.jpg" />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://photography-site-8pct.onrender.com/"
    />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Jr Photography" />
    <meta
      name="twitter:description"
      content="Award-winning photography specializing in weddings, portraits, and events."
    />
    <meta name="twitter:image" content="images/hero.jpg" />

    <!-- Canonical URL -->
    <link rel="canonical" href="https://photography-site-8pct.onrender.com" />

    <!-- Styles and Favicon -->
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="icon" type="image/svg+xml" href="/images/icon.png" />

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "ProfessionalService",
        "name": "Jr Photography",
        "url": "https://photography-site-8pct.onrender.com",
        "image": "https://photography-site-8pct.onrender.com/images/hero.jpg",
        "description": "Award-winning photography specializing in weddings, portraits, and events.",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Nyeri",
          "addressRegion": "Karatina",
          "addressCountry": "Kenya"
        },
        "sameAs": [
          "https://instagram.com/yourprofile",
          "https://facebook.com/yourprofile"
        ]
      }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Book a Session</title>
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body>
    <header>
      <a href="index.html" class="logo">
        <img src="images/icon.png" alt="JR Pixels Logo" />
      </a>
      <nav>
        <ul class="nav-links">
          <li><a href="index.html">Home</a></li>
        </ul>
      </nav>
    </header>

    <main>
      <section id="booking-system">
        <h1 style="text-align: center">Book Your Photography Session</h1>

        <!-- Update the booking confirmation div in your HTML -->
        <div
          id="booking-confirmation"
          style="
            display: none;
            text-align: center;
            padding: 50px;
            background-color: #e6ffe6;
            border: 1px solid #00cc00;
            border-radius: 8px;
            max-width: 600px;
            margin: 0 auto;
          "
        >
          <h2 style="color: #00cc00">‚úÖ Booking Confirmed!</h2>
          <p>Thank you for booking with us.</p>

          <!-- Confirmation status messages will be inserted here -->
          <div id="confirmation-message"></div>

          <div
            style="
              background-color: white;
              padding: 20px;
              margin: 20px 0;
              border-radius: 8px;
            "
          >
            <h3 style="margin-top: 0">Your Session Details:</h3>
            <p><strong>üì¶ Package:</strong> <span id="conf-package"></span></p>
            <p><strong>üìÖ Date:</strong> <span id="conf-date"></span></p>
            <p><strong>‚è∞ Time:</strong> <span id="conf-time"></span></p>
            <p><strong>‚úâÔ∏è Email:</strong> <span id="conf-email"></span></p>
            <p><strong>üì± Phone:</strong> <span id="conf-phone"></span></p>
          </div>

          <!-- WhatsApp Confirmation Button (hidden on customer view) -->
          <a
            id="whatsapp-confirm-btn"
            href="#"
            target="_blank"
            style="display: none"
          >
          </a>

          <p style="font-size: 14px; color: #666; margin-top: 20px">
            Please check your email for detailed confirmation. We'll also send
            you a WhatsApp message shortly to confirm your booking.
          </p>

          <a
            href="index.html"
            class="btn"
            style="
              margin-top: 20px;
              display: inline-block;
              background-color: #4caf50;
              color: white;
              padding: 12px 25px;
              text-decoration: none;
              border-radius: 5px;
            "
          >
            Return Home
          </a>
        </div>

        <form id="booking-form" class="form-container">
          <h2>Step 1: Choose Session Type</h2>
          <div class="form-group">
            <label for="session_type">Select Package/Session *</label>
            <select id="session_type" name="session_type" required>
              <option value="">-- Loading packages... --</option>
            </select>
            <p class="error-message" id="error-session_type">
              Please select a session type.
            </p>
          </div>

          <h2>Step 2: Pick Date & Time</h2>

          <div class="form-group" style="text-align: center">
            <div
              style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 10px;
              "
            >
              <button type="button" class="btn secondary" id="prev-month-btn">
                &lt; Prev
              </button>
              <h3 id="current-month-year"></h3>
              <button type="button" class="btn secondary" id="next-month-btn">
                Next &gt;
              </button>
            </div>
            <div id="booking-calendar">
              <div class="weekday">Sun</div>
              <div class="weekday">Mon</div>
              <div class="weekday">Tue</div>
              <div class="weekday">Wed</div>
              <div class="weekday">Thu</div>
              <div class="weekday">Fri</div>
              <div class="weekday">Sat</div>
            </div>
            <input type="hidden" id="selected_date" name="date" required />
            <p class="error-message" id="error-date">Please select a date.</p>
          </div>

          <div class="form-group">
            <label>Available Time Slots *</label>
            <div class="time-slot-picker" id="time-slot-picker"></div>
            <input type="hidden" id="selected_time" name="time" required />
            <p class="error-message" id="error-time">
              Please select an available time.
            </p>
          </div>

          <h2>Step 3: Your Information</h2>
          <div class="form-group">
            <label for="name">Full Name *</label>
            <input type="text" id="name" name="name" required />
            <p class="error-message" id="error-name">
              Please enter your full name.
            </p>
          </div>

          <div class="form-group">
            <label for="email">Email *</label>
            <input type="email" id="email" name="email" required />
            <p class="error-message" id="error-email">
              Please enter a valid email address.
            </p>
          </div>

          <div class="form-group">
            <label for="phone">Phone Number *</label>
            <input type="tel" id="phone" name="phone" required />
            <p class="error-message" id="error-phone">
              Please enter a valid phone number (e.g., 555-555-5555).
            </p>
          </div>

          <div class="form-group">
            <label for="notes">Notes (Optional)</label>
            <textarea id="notes" name="notes" rows="4"></textarea>
          </div>

          <button type="submit" class="btn" id="submit-booking-btn">
            Confirm Booking
          </button>
        </form>
      </section>
    </main>

    <footer>
      <p>&copy; 2025 Jr Photography. All rights reserved.</p>
    </footer>

    <script>
      // Load packages from database when page loads
      async function loadPackages() {
        const selectEl = document.getElementById("session_type");

        try {
          const response = await fetch("/api/packages");

          if (!response.ok) {
            throw new Error("Failed to fetch packages");
          }

          const packages = await response.json();

          // Clear loading option
          selectEl.innerHTML = '<option value="">-- Please Select --</option>';

          // Add each package as an option
          packages.forEach((pkg) => {
            const option = document.createElement("option");
            option.value = pkg.name;
            option.textContent = `${pkg.name} (Ksh${pkg.price})`;
            selectEl.appendChild(option);
          });

          // Check if a package was pre-selected from URL
          const urlParams = new URLSearchParams(window.location.search);
          const preSelectedPackage = urlParams.get("package");

          if (preSelectedPackage) {
            selectEl.value = preSelectedPackage;
          }
        } catch (error) {
          console.error("Error loading packages:", error);
          selectEl.innerHTML =
            '<option value="">-- Error loading packages --</option>';
        }
      }

      // Load packages when page loads
      document.addEventListener("DOMContentLoaded", loadPackages);
    </script>
    <script src="js/script.js"></script>
    <script src="js/booking.js"></script>
  </body>
</html>
